; Code fragments for later inclusion in Liara Forth 
; Scot W. Stevenson <scot.stevenson@gmail.com>
; First version: 28. Mär 2016
; This version: 28. Mär 2016

; DELETE THESE AS THEY ARE INCLUDED IN FINAL CODE

; ON ( -- f) - links to TRUE; 265SXB specific
; OFF ( -- f ) - links to code of FALSE; 265SXB specific


; LED ( f --) Turn 265SXB LED on or off. Flags: N, 15b, 22 cycles
; use: ON LED, OFF LED
; Note this code screws the other flags in LEDADDR (Port 7) if they are not
; supposed to be unset ("0"). Consider rewriting code to preserve them.

h_led:          .a8
                lda.dx 00       ; load TOS LSB
                eor.# ff        ; flip bits
                and.# 04        ; mask bit 2 that triggers LED
                sta LEDADDR
                .a16
                inx
e_led:          inx
                rts


; BUFFER CODE

; Two input buffers at 7d00 and 7c00, current buffer address is stored 
; at CURBUF in DP. Use bit flip to switch buffers

; Switch buffers. Assumes .A16
;
                lda.d curbuf
                eor.# 0100
                sta.d curbuf

; Clear current buffer. Assumes .A16

                sty.d tmptos
                ldy.# 0000
                tya
*               sta.diy curbuf  ; STA (curbuf),Y
                dey
                dey
                bne -
                ldy.d tmptos
